# KubeOperator kubeconfig 未授权访问漏洞 CVE-2023-22480

## 漏洞描述

KubeOperator 是一个开源的轻量级 Kubernetes 发行版，专注于帮助企业规划、部署和运营生产级别的 Kubernetes 集群。CVE-2023-22480 中，由于下载kubeconfig的路径不需要身份认证，导致攻击者可直接下载kubeconfig获取相关敏感信息。

## 漏洞影响

<a-checkbox checked>KubeOperator  < 3.16.4</a-checkbox></br>

## 网络测绘

<a-checkbox checked>app="KubeOperator"</a-checkbox></br>

## 漏洞复现

登陆页面

![img](/assets/PeiQi-Wiki/img/1682430105792-11c93a6d-2d49-4c29-82a5-f387cef4bfc6.png)

在补丁中修复了配置文件下载接口的未授权

![img](/assets/PeiQi-Wiki/img/1682430157296-4f0da22a-e1a3-44fc-aa39-cd55da6bc593.png)

当集群存在时可通过接口未授权下载配置文件

![img](/assets/PeiQi-Wiki/img/1682430179027-436d1530-2754-48b8-92ad-726341f83dca.png)

验证POC (k8s为集群名称，不固定)

```php
/api/v1/clusters/kubeconfig/k8s
```

![img](/assets/PeiQi-Wiki/img/1682430278944-34ab7f8b-98df-4570-980c-0e2c7338ef75.png)