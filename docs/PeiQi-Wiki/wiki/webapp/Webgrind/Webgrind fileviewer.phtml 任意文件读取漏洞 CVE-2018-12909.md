# Webgrind fileviewer.phtml 任意文件读取漏洞 CVE-2018-12909

## 漏洞描述

Webgrind是一套PHP执行时间分析工具。其中Webgrind 1.5版本中存在安全漏洞，该漏洞源于程序依靠用户输入来显示文件。攻击者可以通过漏洞读取服务器敏感文件

## 漏洞影响

<a-checkbox checked>Webgrind <= 1.5</a-checkbox></br>

## 网络测绘

<a-checkbox checked>app="Webgrind"</a-checkbox></br>

## 漏洞复现

主页面

![img](/assets/PeiQi-Wiki/img/1661596655330-55288965-9281-4c56-924c-b3f07951093f.png)

方法调用在 index.php 中

![img](/assets/PeiQi-Wiki/img/1661596715954-2bc1af96-68be-445a-9509-f1bd225109b5.png)

当参数为 fileviewer 时，将参数传递包含在文件 templates/fileviewer.phtml 中

![img](/assets/PeiQi-Wiki/img/1661596833979-0efa39c3-d2c7-4464-b2ef-db1f1f62759e.png)

参数 file 传入 `fileviewer.phtml` 通过函数 `highlight_file` 显示在页面中， 验证POC

```php
/index.php?op=fileviewer&file=/etc/passwd
```

![img](/assets/PeiQi-Wiki/img/1661597383081-351322c2-a214-4ffd-8878-a718d51b5e64.png)