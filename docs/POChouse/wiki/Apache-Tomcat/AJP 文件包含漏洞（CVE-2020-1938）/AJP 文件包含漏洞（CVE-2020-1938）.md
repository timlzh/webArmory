## 漏洞概述

Ghostcat（幽灵猫） 是由长亭科技安全研究员发现的存在于 Tomcat 中的安全漏洞，由于 Tomcat AJP 协议设计上存在缺陷，攻击者通过 Tomcat AJP Connector 可以读取或包含 Tomcat 上所有 webapp 目录下的任意文件，例如可以读取 webapp 配置文件或源代码。

此外在目标应用有文件上传功能的情况下，配合文件包含的利用还可以达到远程代码执行的危害。

## 影响范围

```http
#影响版本 8009端口
Apache Tomcat 9.x < 9.0.31
Apache Tomcat 8.x < 8.5.51
Apache Tomcat 7.x < 7.0.100
Apache Tomcat 6.x
```

## POC

Tomcat AJP Connector 默认配置下即为开启状态，且监听在 0.0.0.0:8009，用长亭的Xray检测即可

```bash
xray servicescan --target 127.0.0.1:8009

或者Goby也有此POC
```

## EXP

一个比较全的Tomcat利用工具-https://github.com/hypn0s/AJPy

- WAR包 上传
- 利用CVE-2020-1938读取文件等

## 参考链接

[Ghostcat（幽灵猫）](https://www.chaitin.cn/zh/ghostcat) 