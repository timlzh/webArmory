# CVE-2021-3156 (Baron Samedit) Sudo 中基于堆的缓冲区溢出漏洞

Qualys研究小组发现了sudo中的堆溢出漏洞，该漏洞在类似Unix的主要操作系统上都可以使用。通过利用此漏洞，任何没有特权的用户都可以使用默认的sudo配置在易受攻击的主机上获得root特权。

**受影响版本：**

* 从1.8.2到1.8.31p2的所有旧版
* 从1.9.0到1.9.5p1的所有稳定版本

用户可以使用非root的账户登录系统，运行“ sudoedit -s / ”命令，若返回以“ sudoedit：”开头的错误，则当前系统可能存在安全风险。不受影响的系统将显示以“ usage：”开头的错误。

**PoC：**

https://haxx.in/CVE-2021-3156_nss_poc_ubuntu.tar.gz

https://github.com/r4j0x00/exploits/tree/master/CVE-2021-3156

https://github.com/lockedbyte/CVE-Exploits/tree/master/CVE-2021-3156

PoC验证视频：https://vimeo.com/504872555

详情：https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit

